var Favorites;function favorites_after_button_submit(t,e,a,o){}function favorites_after_initial_load(t){}(Favorites=Favorites||{}).Utilities=function(){var t=this,e=jQuery;t.isFavorite=function(a,t){var o=!1;return e.each(t,function(t,e){e.post_id===parseInt(a)&&(o=!0),parseInt(e.post_id)===a&&(o=!0)}),o},t.objectLength=function(t){var e,a=0;for(e in t)t.hasOwnProperty(e)&&a++;return a},t.siteIndex=function(t){for(var e=0;e<Favorites.userFavorites.length;e++)if(Favorites.userFavorites[e].site_id===parseInt(t))return e},t.getThumbnail=function(t,e){var a=t.thumbnails;if(void 0===a||0==a.length)return!1;var o=a[e];return void 0!==o&&(o||!1)}},(Favorites=Favorites||{}).Formatter=function(){var s=jQuery;this.addFavoriteCount=function(t,e){return Favorites.jsData.button_options.include_count?(e<=0&&(e=0),t+=' <span class="simplefavorite-button-count">'+e+"</span>"):t},this.decrementAllCounts=function(){for(var t=s(".simplefavorite-button.active.has-count"),e=0;e<t.length;e++){var a=s(t)[e],o=s(a).find(".simplefavorite-button-count"),i=s(o).text()-1;s(a).attr("data-favoritecount",i)}}},(Favorites=Favorites||{}).ButtonOptionsFormatter=function(){var s=this,r=jQuery;s.options=Favorites.jsData.button_options,s.formatter=new Favorites.Formatter,s.format=function(t,e){s.options.custom_colors&&s.colors(t,e),s.html(t,e)},s.html=function(t,e){var a=r(t).attr("data-favoritecount"),o=s.options.button_type,i="";return"custom"===s.options.button_type?(e&&r(t).html(s.formatter.addFavoriteCount(Favorites.jsData.favorited,a)),e||r(t).html(s.formatter.addFavoriteCount(Favorites.jsData.favorite,a)),s.applyIconColor(t,e),void s.applyCountColor(t,e)):e?(i+='<i class="'+o.icon_class+'"></i> ',i+=o.state_active,void r(t).html(s.formatter.addFavoriteCount(i,a))):(i+='<i class="'+o.icon_class+'"></i> ',i+=o.state_default,r(t).html(s.formatter.addFavoriteCount(i,a)),s.applyIconColor(t,e),void s.applyCountColor(t,e))},s.colors=function(t,e){if(s.options.custom_colors){var a;if(e)return(a=s.options.active).background_active&&r(t).css("background-color",a.background_active),a.border_active&&r(t).css("border-color",a.border_active),void(a.text_active&&r(t).css("color",a.text_active));(a=s.options.default).background_default&&r(t).css("background-color",a.background_default),a.border_default&&r(t).css("border-color",a.border_default),a.text_default&&r(t).css("color",a.text_default),s.boxShadow(t)}},s.boxShadow=function(t){s.options.box_shadow||(r(t).css("box-shadow","none"),r(t).css("-webkit-box-shadow","none"),r(t).css("-moz-box-shadow","none"))},s.applyIconColor=function(t,e){s.options.custom_colors&&(e&&s.options.active.icon_active&&r(t).find("i").css("color",s.options.active.icon_active),!e&&s.options.default.icon_default&&r(t).find("i").css("color",s.options.default.icon_default))},s.applyCountColor=function(t,e){s.options.custom_colors&&(e&&s.options.active.count_active?r(t).find(Favorites.selectors.count).css("color",s.options.active.count_active):!e&&s.options.default.count_default&&r(t).find(Favorites.selectors.count).css("color",s.options.default.count_default))}},(Favorites=Favorites||{}).NonceGenerator=function(){var t=this,e=jQuery;return t.bindEvents=function(){e(document).ready(function(){Favorites.jsData.dev_mode&&(console.log("Favorites Localized Data"),console.log(Favorites.jsData)),t.getNonce()})},t.getNonce=function(){""!==Favorites.jsData.cache_enabled?e.ajax({url:Favorites.jsData.ajaxurl,type:"POST",datatype:"json",data:{action:Favorites.formActions.nonce,logged_in:Favorites.jsData.logged_in,user_id:Favorites.jsData.user_id},success:function(t){Favorites.jsData.nonce=t.nonce,Favorites.jsData.dev_mode&&console.log("Nonce successfully generated: "+t.nonce),e(document).trigger("favorites-nonce-generated",[t.nonce])}}):Favorites.jsData.nonce=favorites_data.nonce},t.bindEvents()},(Favorites=Favorites||{}).UserFavorites=function(){var e=this,a=jQuery;return e.initialLoad=!1,e.bindEvents=function(){a(document).on("favorites-nonce-generated",function(){e.initialLoad=!0,e.getFavorites()})},e.getFavorites=function(){a.ajax({url:Favorites.jsData.ajaxurl,type:"POST",datatype:"json",data:{action:Favorites.formActions.favoritesarray,logged_in:Favorites.jsData.logged_in,user_id:Favorites.jsData.user_id},success:function(t){Favorites.jsData.dev_mode&&(console.log("The current user favorites were successfully loaded."),console.log(t)),Favorites.userFavorites=t.favorites,a(document).trigger("favorites-user-favorites-loaded",[e.initialLoad]),a(document).trigger("favorites-update-all-buttons"),e.initialLoad&&favorites_after_initial_load(Favorites.userFavorites)},error:function(t){Favorites.jsData.dev_mode&&(console.log("The was an error loading the user favorites."),console.log(t))}})},e.bindEvents()},(Favorites=Favorites||{}).Clear=function(){var i=this,s=jQuery;return i.activeButton,i.utilities=new Favorites.Utilities,i.formatter=new Favorites.Formatter,i.bindEvents=function(){s(document).on("click",Favorites.selectors.clear_button,function(t){t.preventDefault(),i.activeButton=s(this),i.clearFavorites()}),s(document).on("favorites-updated-single",function(){i.updateClearButtons()}),s(document).on("favorites-user-favorites-loaded",function(){i.updateClearButtons()})},i.clearFavorites=function(){i.loading(!0);var e=s(i.activeButton).attr("data-siteid");s.ajax({url:Favorites.jsData.ajaxurl,type:"post",datatype:"json",data:{action:Favorites.formActions.clearall,nonce:Favorites.jsData.nonce,siteid:e,logged_in:Favorites.jsData.logged_in,user_id:Favorites.jsData.user_id},success:function(t){Favorites.jsData.dev_mode&&(console.log("Favorites list successfully cleared."),console.log(t)),Favorites.userFavorites=t.favorites,i.formatter.decrementAllCounts(),i.loading(!1),i.clearSiteFavorites(e),s(document).trigger("favorites-cleared",[i.activeButton,t.old_favorites]),s(document).trigger("favorites-update-all-buttons")},error:function(t){Favorites.jsData.dev_mode&&(console.log("There was an error clearing the favorites list."),console.log(t))}})},i.loading=function(t){if(t)return s(i.activeButton).addClass(Favorites.cssClasses.loading),void s(i.activeButton).attr("disabled","disabled");s(i.activeButton).removeClass(Favorites.cssClasses.loading)},i.updateClearButtons=function(){for(var t,e,a=0;a<s(Favorites.selectors.clear_button).length;a++){t=s(Favorites.selectors.clear_button)[a],e=s(t).attr("data-siteid");for(var o=0;o<Favorites.userFavorites.length;o++)Favorites.userFavorites[o].site_id===parseInt(e)&&(0<i.utilities.objectLength(Favorites.userFavorites[o].posts)?s(t).attr("disabled",!1):s(t).attr("disabled","disabled"))}},i.clearSiteFavorites=function(a){s.each(Favorites.userFavorites,function(t,e){this.site_id===parseInt(a)&&(Favorites.userFavorites[t].posts={})})},i.bindEvents()},(Favorites=Favorites||{}).Lists=function(){var u=this,v=jQuery;return u.utilities=new Favorites.Utilities,u.buttonFormatter=new Favorites.ButtonOptionsFormatter,u.bindEvents=function(){v(document).on("favorites-update-all-lists",function(){u.updateAllLists()}),v(document).on("favorites-updated-single",function(){u.updateAllLists()}),v(document).on("favorites-cleared",function(){u.updateAllLists()}),v(document).on("favorites-user-favorites-loaded",function(){u.updateAllLists()})},u.updateAllLists=function(){for(var t=0;t<Favorites.userFavorites.length;t++)for(var e=v(Favorites.selectors.list+'[data-siteid="'+Favorites.userFavorites[t].site_id+'"]'),a=0;a<v(e).length;a++){var o=v(e)[a];u.updateSingleList(o)}},u.updateSingleList=function(a){var t=v(a).attr("data-userid"),e=v(a).attr("data-siteid"),o=v(a).attr("data-includelinks"),i=v(a).attr("data-includebuttons"),s=v(a).attr("data-includethumbnails"),r=v(a).attr("data-thumbnailsize"),n=v(a).attr("data-includeexcerpts"),d=v(a).attr("data-posttypes"),c=v(a).attr("data-nofavoritestext");v.ajax({url:Favorites.jsData.ajaxurl,type:"post",dataType:"json",data:{action:Favorites.formActions.favoritelist,nonce:Favorites.jsData.nonce,userid:t,siteid:e,include_links:o,include_buttons:i,include_thumbnails:s,thumbnail_size:r,include_excerpt:n,no_favorites:c,post_types:d,user_id_current:Favorites.jsData.user_id,logged_in:Favorites.jsData.logged_in},success:function(t){Favorites.jsData.dev_mode&&(console.log("Favorites list successfully retrieved."),console.log(v(a)),console.log(t));var e=v(t.list);v(a).replaceWith(e),u.removeButtonLoading(e),v(document).trigger("favorites-list-updated",[e])},error:function(t){Favorites.jsData.dev_mode&&(console.log("There was an error updating the list."),console.log(a),console.log(t))}})},u.removeButtonLoading=function(t){var e=v(t).find(Favorites.selectors.button);v.each(e,function(){u.buttonFormatter.format(v(this),!1),v(this).removeClass(Favorites.cssClasses.active),v(this).removeClass(Favorites.cssClasses.loading)})},u.removeInvalidListItems=function(t,o){var e=v(t).find("li[data-postid]");v.each(e,function(t,e){var a=v(this).attr("data-postid");u.utilities.isFavorite(a,o)||v(this).remove()})},u.bindEvents()},(Favorites=Favorites||{}).Button=function(){var e=this,a=jQuery;return e.activeButton,e.allButtons,e.authenticated=!0,e.formatter=new Favorites.Formatter,e.data={},e.bindEvents=function(){a(document).on("click",Favorites.selectors.button,function(t){t.preventDefault(),e.activeButton=a(this),e.setAllButtons(),e.submitFavorite()})},e.setAllButtons=function(){var t=a(e.activeButton).attr("data-postid");e.allButtons=a('button[data-postid="'+t+'"]')},e.setData=function(){e.data.post_id=a(e.activeButton).attr("data-postid"),e.data.site_id=a(e.activeButton).attr("data-siteid"),e.data.status=a(e.activeButton).hasClass("active")?"inactive":"active"},e.submitFavorite=function(){e.loading(!0),e.setData(),a.ajax({url:Favorites.jsData.ajaxurl,type:"post",dataType:"json",data:{action:Favorites.formActions.favorite,nonce:Favorites.jsData.nonce,postid:e.data.post_id,siteid:e.data.site_id,status:e.data.status,logged_in:Favorites.jsData.logged_in,user_id:Favorites.jsData.user_id},success:function(t){if(Favorites.jsData.dev_mode&&(console.log("The favorite was successfully saved."),console.log(t)),"unauthenticated"===t.status)return Favorites.authenticated=!1,e.loading(!1),e.data.status="inactive",a(document).trigger("favorites-update-all-buttons"),void a(document).trigger("favorites-require-authentication",[e.data]);Favorites.userFavorites=t.favorites,e.loading(!1),e.resetButtons(),a(document).trigger("favorites-updated-single",[t.favorites,e.data.post_id,e.data.site_id,e.data.status]),a(document).trigger("favorites-update-all-buttons"),favorites_after_button_submit(t.favorites,e.data.post_id,e.data.site_id,e.data.status)},error:function(t){Favorites.jsData.dev_mode&&(console.log("There was an error saving the favorite."),console.log(t))}})},e.resetButtons=function(){var t=parseInt(a(e.activeButton).attr("data-favoritecount"));a.each(e.allButtons,function(){if("inactive"===e.data.status)return t<=0&&(t=1),a(this).removeClass(Favorites.cssClasses.active),a(this).attr("data-favoritecount",t-1),void a(this).find(Favorites.selectors.count).text(t-1);a(this).addClass(Favorites.cssClasses.active),a(this).attr("data-favoritecount",t+1),a(this).find(Favorites.selectors.count).text(t+1)})},e.loading=function(t){t?a.each(e.allButtons,function(){a(this).attr("disabled","disabled"),a(this).addClass(Favorites.cssClasses.loading),a(this).html(e.addLoadingIndication())}):a.each(e.allButtons,function(){a(this).attr("disabled",!1),a(this).removeClass(Favorites.cssClasses.loading)})},e.addLoadingIndication=function(t){return"1"!==Favorites.jsData.indicate_loading?t:"active"===e.data.status?Favorites.jsData.loading_text+Favorites.jsData.loading_image_active:Favorites.jsData.loading_text+Favorites.jsData.loading_image},e.bindEvents()},(Favorites=Favorites||{}).ButtonUpdater=function(){var o=this,i=jQuery;return o.utilities=new Favorites.Utilities,o.formatter=new Favorites.Formatter,o.buttonFormatter=new Favorites.ButtonOptionsFormatter,o.activeButton,o.data={},o.bindEvents=function(){i(document).on("favorites-update-all-buttons",function(){o.updateAllButtons()}),i(document).on("favorites-list-updated",function(t,e){o.updateAllButtons(e)})},o.updateAllButtons=function(t){for(var e=void 0===typeof t&&""!==t?i(t).find(Favorites.selectors.button):i(Favorites.selectors.button),a=0;a<i(e).length;a++)o.activeButton=i(e)[a],Favorites.authenticated&&o.setButtonData(),Favorites.authenticated&&o.utilities.isFavorite(o.data.postid,o.data.site_favorites)?(o.buttonFormatter.format(i(o.activeButton),!0),i(o.activeButton).addClass(Favorites.cssClasses.active)):(o.buttonFormatter.format(i(o.activeButton),!1),i(o.activeButton).removeClass(Favorites.cssClasses.active)),i(o.activeButton).removeClass(Favorites.cssClasses.loading),i(o.activeButton).find(Favorites.selectors.count).text(o.data.favorite_count)},o.setButtonData=function(){o.data.postid=i(o.activeButton).attr("data-postid"),o.data.siteid=i(o.activeButton).attr("data-siteid"),o.data.favorite_count=i(o.activeButton).attr("data-favoritecount"),o.data.site_index=o.utilities.siteIndex(o.data.siteid),o.data.site_favorites=Favorites.userFavorites[o.data.site_index].posts,o.data.favorite_count<=0&&(o.data.favorite_count=0)},o.bindEvents()},(Favorites=Favorites||{}).TotalCount=function(){var t=this,n=jQuery;return t.bindEvents=function(){n(document).on("favorites-updated-single",function(){t.updateTotal()}),n(document).on("favorites-cleared",function(){t.updateTotal()}),n(document).on("favorites-user-favorites-loaded",function(){t.updateTotal()})},t.updateTotal=function(){for(var t=0;t<n(Favorites.selectors.total_favorites).length;t++){for(var e=n(Favorites.selectors.total_favorites)[t],a=parseInt(n(e).attr("data-siteid")),o=n(e).attr("data-posttypes").split(","),i=0,s=0;s<Favorites.userFavorites.length;s++){var r=Favorites.userFavorites[s];r.site_id===a&&n.each(r.posts,function(){"all"!==n(e).attr("data-posttypes")?-1!==n.inArray(this.post_type,o)&&i++:i++})}n(e).text(i)}},t.bindEvents()},(Favorites=Favorites||{}).PostFavoriteCount=function(){var s=this,d=jQuery;return s.bindEvents=function(){d(document).on("favorites-updated-single",function(t,e,a,o,i){if("active"===i)return s.updateCounts();s.decrementSingle(a,o)}),d(document).on("favorites-cleared",function(t,e,a){s.updateCounts(a,!0)})},s.updateCounts=function(t,e){void 0!==t&&""!==t||(t=Favorites.userFavorites),void 0!==e&&""!==e||(e=!1);for(var a=0;a<d("["+Favorites.selectors.post_favorite_count+"]").length;a++){var o=d("["+Favorites.selectors.post_favorite_count+"]")[a],i=parseInt(d(o).attr(Favorites.selectors.post_favorite_count)),s=d(o).attr("data-siteid");""===s&&(s="1");for(var r=0;r<t.length;r++){var n=t[r];n.site_id===parseInt(s)&&d.each(n.posts,function(){if(this.post_id===i){if(e){var t=parseInt(this.total)-1;return void d(o).text(t)}d(o).text(this.total)}})}}},s.decrementSingle=function(t,e){for(var a=0;a<d("["+Favorites.selectors.post_favorite_count+"]").length;a++){var o=d("["+Favorites.selectors.post_favorite_count+"]")[a],i=d(o).attr(Favorites.selectors.post_favorite_count),s=d(o).attr("data-siteid");if(""===s&&(s="1"),s===e&&i===t){var r=parseInt(d(o).text())-1;d(o).text(r)}}},s.bindEvents()},(Favorites=Favorites||{}).RequireAuthentication=function(){var e=this,a=jQuery;return e.bindEvents=function(){a(document).on("favorites-require-authentication",function(){Favorites.jsData.dev_mode&&console.log("Unauthenticated user was prevented from favoriting."),Favorites.jsData.authentication_redirect?e.redirect():e.openModal()}),a(document).on("click",".simplefavorites-modal-backdrop",function(t){e.closeModal()}),a(document).on("click","["+Favorites.selectors.close_modals+"]",function(t){t.preventDefault(),e.closeModal()})},e.redirect=function(){window.location=Favorites.jsData.authentication_redirect_url},e.openModal=function(){e.buildModal(),setTimeout(function(){a("["+Favorites.selectors.modals+"]").addClass("active")},10)},e.buildModal=function(){if(!(0<a("["+Favorites.selectors.modals+"]").length)){var t='<div class="simplefavorites-modal-backdrop" '+Favorites.selectors.modals+"></div>";t+='<div class="simplefavorites-modal-content" '+Favorites.selectors.modals+">",t+='<div class="simplefavorites-modal-content-body">',t+=Favorites.jsData.authentication_modal_content,t+="</div>\x3c!-- .simplefavorites-modal-content-body --\x3e",t+="</div>\x3c!-- .simplefavorites-modal-content --\x3e",a("body").prepend(t)}},e.closeModal=function(){a("["+Favorites.selectors.modals+"]").removeClass("active"),a(document).trigger("favorites-modal-closed")},e.bindEvents()},jQuery(document).ready(function(){new Favorites.Factory}),(Favorites=Favorites||{}).selectors={button:".simplefavorite-button",list:".favorites-list",clear_button:".simplefavorites-clear",total_favorites:".simplefavorites-user-count",modals:"data-favorites-modal",close_modals:"data-favorites-modal-close",count:".simplefavorite-button-count",post_favorite_count:"data-favorites-post-count-id"},Favorites.cssClasses={loading:"loading",active:"active"},Favorites.jsData={ajaxurl:favorites_data.ajaxurl,nonce:null,favorite:favorites_data.favorite,favorited:favorites_data.favorited,include_count:favorites_data.includecount,indicate_loading:favorites_data.indicate_loading,loading_text:favorites_data.loading_text,loading_image_active:favorites_data.loading_image_active,loading_image:favorites_data.loading_image,cache_enabled:favorites_data.cache_enabled,authentication_modal_content:favorites_data.authentication_modal_content,authentication_redirect:favorites_data.authentication_redirect,authentication_redirect_url:favorites_data.authentication_redirect_url,button_options:favorites_data.button_options,dev_mode:favorites_data.dev_mode,logged_in:favorites_data.logged_in,user_id:favorites_data.user_id},Favorites.userFavorites=null,Favorites.authenticated=!0,Favorites.formActions={nonce:"favorites_nonce",favoritesarray:"favorites_array",favorite:"favorites_favorite",clearall:"favorites_clear",favoritelist:"favorites_list"},Favorites.Factory=function(){jQuery;return this.build=function(){new Favorites.NonceGenerator,new Favorites.UserFavorites,new Favorites.Lists,new Favorites.Clear,new Favorites.Button,new Favorites.ButtonUpdater,new Favorites.TotalCount,new Favorites.PostFavoriteCount,new Favorites.RequireAuthentication},this.build()};